<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Getting-started-with-scrobbler-part-2</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Getting-started-with-scrobbler-part-2</h1>



<p>As a quick recap from part 1, scrobbling is a service offered by
Last.fm, where any music you listen to on other platforms (i.e.,
Spotify) is recorded and stored by Last.fm, along with a timestamp and
associated metadata. <code>scrobbler</code> is intended as an interface
to that database, so you can download and explore your music history
with the full freedom of R. Please note, this 2nd part assumes you have
already set up a Last.fm account and have at least one song already
scrobbled.</p>
<p>As an aside on what <code>scrobbler</code> is not:
<code>scrobbler</code> is not intended to be a general wrapper around
the Last.fm scrobble API. The <a href="https://www.last.fm/api/scrobbling">full API</a> has a lot of
methods available, but the <code>scrobbler</code> package is designed to
do one thing; download your listening history into R. If there is other
functionality of the API you’d like to see in <code>scrobbler</code>,
please reach out on <a href="https://github.com/condwanaland/scrobbler/issues">github</a>.</p>
<div id="getting-set-up" class="section level3">
<h3>Getting set up</h3>
<p>In addition to having a Last.fm account, downloading your scrobbles
requires you to have an API key (this just authenricates you with
Last.fm). To get an API key, you can go through the process <a href="https://www.last.fm/api/account/create">here</a> (it takes less
than 5 mins). Note you should only have to fill out the name and
descripton, and you just have to describe that you are downloading your
scrobble history for personal analysis. Dont worry about the callback
url or homepage. Once you’ve gone through that step, you should be
provided with an API key. Save this key somewhere secure!</p>
</div>
<div id="downloading-your-music-history" class="section level3">
<h3>Downloading your music history</h3>
<p>Now it should be smooth sailing from here. Make sure you start by
loading scrobbler</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(scrobbler)</span></code></pre></div>
<p>And now call the <code>download_scrobbles</code> function, using your
username and API key, to start downloading your tracks.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>my_songs <span class="ot">&lt;-</span> <span class="fu">download_scrobbles</span>(</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>  <span class="at">username =</span> <span class="st">&quot;your_username&quot;</span>,</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>  <span class="at">api_key =</span> <span class="st">&quot;your_api_key&quot;</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>  )</span></code></pre></div>
<p>And thats it! You should now have a dataframe called ‘my_songs’ that
contains info one row for each song you listened to, along with its
timestamp. You can now analyse this in any way you choose. Lets have a
look at what it looks like</p>
<pre><code>#&gt;                               song_mbid         song_title
#&gt; 1  192915d7-c2df-44f6-9e08-b7d80745bdd3            So Soon
#&gt; 2  6dd374d1-e707-4de0-89b3-889fbb7d7bad             B Team
#&gt; 3  45d25340-5791-4f93-a642-94494b057646       Toy Soldiers
#&gt; 4  0f361896-d6fc-4179-9987-47bf59437c83            Stutter
#&gt; 5  34d419dd-eaf7-48de-b4df-704c61463cd7            Fallout
#&gt; 6  3c8fe6d5-66ac-3b8b-a3f5-36f63fcff693          Porcelain
#&gt; 7  0050b4bf-21d2-47f2-a306-4af3dad79018 Desperate Measures
#&gt; 8  4d834fbe-e72d-3e06-88d9-da4945421182      Truth Or Dare
#&gt; 9  0ddd52c6-45ed-4064-add0-5d0f0f29af34             By Now
#&gt; 10 0651a786-0711-4ab8-8eee-148d277c143a           My World
#&gt;                             artist_mbid          artist
#&gt; 1  e358276d-4377-4b9b-88dd-db0d17b0e3c6 Marianas Trench
#&gt; 2  e358276d-4377-4b9b-88dd-db0d17b0e3c6 Marianas Trench
#&gt; 3  e358276d-4377-4b9b-88dd-db0d17b0e3c6 Marianas Trench
#&gt; 4  e358276d-4377-4b9b-88dd-db0d17b0e3c6 Marianas Trench
#&gt; 5  e358276d-4377-4b9b-88dd-db0d17b0e3c6 Marianas Trench
#&gt; 6  e358276d-4377-4b9b-88dd-db0d17b0e3c6 Marianas Trench
#&gt; 7  e358276d-4377-4b9b-88dd-db0d17b0e3c6 Marianas Trench
#&gt; 8  e358276d-4377-4b9b-88dd-db0d17b0e3c6 Marianas Trench
#&gt; 9  e358276d-4377-4b9b-88dd-db0d17b0e3c6 Marianas Trench
#&gt; 10 0103c1cc-4a09-4a5d-a344-56ad99a77193   Avril Lavigne
#&gt;                              album_mbid      album  date_unix
#&gt; 1  180bb020-8349-4031-b8a3-bb544a396d84 Ever After         NA
#&gt; 2  180bb020-8349-4031-b8a3-bb544a396d84 Ever After 1608151945
#&gt; 3  180bb020-8349-4031-b8a3-bb544a396d84 Ever After 1608151694
#&gt; 4  180bb020-8349-4031-b8a3-bb544a396d84 Ever After 1608151493
#&gt; 5  180bb020-8349-4031-b8a3-bb544a396d84 Ever After 1608151238
#&gt; 6  180bb020-8349-4031-b8a3-bb544a396d84 Ever After 1608150918
#&gt; 7  180bb020-8349-4031-b8a3-bb544a396d84 Ever After 1608150689
#&gt; 8  180bb020-8349-4031-b8a3-bb544a396d84 Ever After 1608150459
#&gt; 9  180bb020-8349-4031-b8a3-bb544a396d84 Ever After 1608150203
#&gt; 10 002a0094-40b7-4403-99ab-f3b0daeffacd     Let Go 1608118840
#&gt;                  date
#&gt; 1                &lt;NA&gt;
#&gt; 2  16 Dec 2020, 20:52
#&gt; 3  16 Dec 2020, 20:48
#&gt; 4  16 Dec 2020, 20:44
#&gt; 5  16 Dec 2020, 20:40
#&gt; 6  16 Dec 2020, 20:35
#&gt; 7  16 Dec 2020, 20:31
#&gt; 8  16 Dec 2020, 20:27
#&gt; 9  16 Dec 2020, 20:23
#&gt; 10 16 Dec 2020, 11:40</code></pre>
<p>The song_, artist_, and album_mbid columns refer to MusicBrainz ID.
MusicBrainz is a music encyclopedia that contains lots of data about
songs, artists, and albums. You can use the ID to access that entry in
MusicBrainz if you want additional metadata (but be warned, these
columns may not always be filled). Accessing MusicBrainz will be covered
in another post.</p>
</div>
<div id="updating-your-dataframe" class="section level3">
<h3>Updating your dataframe</h3>
<p>As you may have noticed, it takes a while to download all your music.
It would be a pain if you had to go through that process everytime you
wanted to make sure your scrobbles were up to date.
<code>scrobbler</code> provides a <code>update_scrobbles</code> function
that makes this easier.</p>
<p>To use <code>update_scrobbles</code> you pass in an existing
dataframe of songs, and supply a date columm (you should use the
<code>date_unix</code> column that is included in scrobble dataframes by
default). This will then only download your new scrobbles not included
in the original dataframe, and create a new one with all your
tracks.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>updated_songs <span class="ot">&lt;-</span> <span class="fu">update_scrobbles</span>(<span class="at">data =</span> my_songs,</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>                                  <span class="at">timestamp_column =</span> <span class="st">&quot;date_unix&quot;</span>,</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>                                  <span class="at">username =</span> <span class="st">&quot;your_username&quot;</span>,</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>                                  <span class="at">api_key =</span> <span class="st">&quot;your_api_key&quot;</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>                                  )</span></code></pre></div>
<p>This is much faster than having to redownload every time. Note that a
current limitation is that if you have added or removed any columns,
this will fail as the new columns will not match the old ones. I plan to
find a neater solution in future versions of <code>scrobbler</code>.</p>
<p>If you have any questions about <code>scrobbler</code>, feel free to
reach out on github. Have fun!</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
